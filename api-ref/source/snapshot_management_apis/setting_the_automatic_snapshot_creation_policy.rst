:original_name: css_03_0031.html

.. _css_03_0031:

Setting the Automatic Snapshot Creation Policy
==============================================

Function
--------

This API is used to set parameters related to automatic snapshot creation. By default, a snapshot is created per day.

URI
---

.. code-block:: text

   POST /v1.0/{project_id}/clusters/{cluster_id}/index_snapshot/policy

.. table:: **Table 1** Parameter description

   +------------+-----------+--------+-----------------------------------------------------------------+
   | Parameter  | Mandatory | Type   | Description                                                     |
   +============+===========+========+=================================================================+
   | project_id | Yes       | String | Project ID.                                                     |
   +------------+-----------+--------+-----------------------------------------------------------------+
   | cluster_id | Yes       | String | ID of the cluster where automatic snapshot creation is enabled. |
   +------------+-----------+--------+-----------------------------------------------------------------+

Request
-------

:ref:`Table 2 <css_03_0031__table82481020121413>` describes the request parameters.

.. _css_03_0031__table82481020121413:

.. table:: **Table 2** Parameter description

   +------------+-----------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter  | Mandatory | Type    | Description                                                                                                                                                                                                                                                                                                                                                                                                                             |
   +============+===========+=========+=========================================================================================================================================================================================================================================================================================================================================================================================================================================+
   | prefix     | Yes       | String  | Prefix of the snapshot name that is automatically created.                                                                                                                                                                                                                                                                                                                                                                              |
   +------------+-----------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | period     | Yes       | String  | Time when a snapshot is created every day. Snapshots can only be created on the hour. The time format is the time followed by the time zone, specifically, **HH:mm z**. In the format, **HH:mm** refers to the hour time and **z** refers to the time zone, for example, **00:00 GMT+08:00** and **01:00 GMT+08:00**.                                                                                                                   |
   +------------+-----------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | keepday    | Yes       | Integer | Number of days that a snapshot can be retained. The value ranges from 1 to 90. The system automatically deletes snapshots that have been retained for the allowed maximum duration on the half hour.                                                                                                                                                                                                                                    |
   +------------+-----------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | enable     | Yes       | String  | Value **true** indicates that the automatic snapshot creation policy is enabled, and value **false** indicates that the automatic snapshot creation policy is disabled.                                                                                                                                                                                                                                                                 |
   +------------+-----------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | deleteAuto | No        | String  | Whether to delete all automatically created snapshots when the automatic snapshot creation policy is disabled. The default value is **false**, indicating that snapshots that have been automatically created are not deleted when the automatic snapshot creation function is disabled. If this parameter is set to **true**, all automatically created snapshots are deleted when the automatic snapshot creation policy is disabled. |
   +------------+-----------+---------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

Response
--------

None

Examples
--------

Example request

.. code-block:: text

   POST /v1.0/6204a5bd270343b5885144cf9c8c158d/clusters/ea244205-d641-45d9-9dcb-ab2236bcd07e/index_snapshot/policy
   {
       "prefix":"snapshot",
       "period":"16:00 GMT+08:00",
       "keepday":7,
       "enable":"true"
   }

Status Code
-----------

:ref:`Table 3 <css_03_0031__table209491933101317>` describes the status code.

.. _css_03_0031__table209491933101317:

.. table:: **Table 3** Status code

   +-------------+----------------+------------------------------------------------------------------------------------------------+
   | Status Code | Code           | Status Code Description                                                                        |
   +=============+================+================================================================================================+
   | 200         | OK             | The request is processed successfully.                                                         |
   +-------------+----------------+------------------------------------------------------------------------------------------------+
   | 406         | Not Acceptable | The server cannot fulfill the request according to the content characteristics of the request. |
   +-------------+----------------+------------------------------------------------------------------------------------------------+
