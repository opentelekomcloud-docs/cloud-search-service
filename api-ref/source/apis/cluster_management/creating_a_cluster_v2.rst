:original_name: CreateClusterMultiRole.html

.. _CreateClusterMultiRole:

Creating a Cluster (V2)
=======================

Function
--------

This API is used to create a cluster with multiple node types (for example, ess, ess-cold, ess-client, ess-master).

URI
---

POST /v2.0/{project_id}/clusters

.. table:: **Table 1** Path Parameters

   +------------+-----------+--------+----------------------------------------------------------------------------------------------------------------------------------+
   | Parameter  | Mandatory | Type   | Description                                                                                                                      |
   +============+===========+========+==================================================================================================================================+
   | project_id | Yes       | String | Project ID. For details about how to obtain the project ID and name, see :ref:`Obtaining the Project ID and Name <css_03_0071>`. |
   +------------+-----------+--------+----------------------------------------------------------------------------------------------------------------------------------+

Request Parameters
------------------

.. table:: **Table 2** Request body parameters

   +-----------+-----------+-------------------------------------------------------------------------------------+-----------------+
   | Parameter | Mandatory | Type                                                                                | Description     |
   +===========+===========+=====================================================================================+=================+
   | cluster   | Yes       | :ref:`CreateClusterBody <createclustermultirole__request_createclusterbody>` object | Cluster object. |
   +-----------+-----------+-------------------------------------------------------------------------------------+-----------------+

.. _createclustermultirole__request_createclusterbody:

.. table:: **Table 3** CreateClusterBody

   +-----------------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter             | Mandatory       | Type                                                                                                            | Description                                                                                                                                                                                                                                                                                                                                                                                                 |
   +=======================+=================+=================================================================================================================+=============================================================================================================================================================================================================================================================================================================================================================================================================+
   | name                  | Yes             | String                                                                                                          | Cluster name It can contain 4 to 32 characters. Only digits, letters, hyphens (-), and underscores (_) are allowed. The value must start with a letter.                                                                                                                                                                                                                                                     |
   +-----------------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | backupStrategy        | No              | :ref:`CreateClusterBackupStrategyBody <createclustermultirole__request_createclusterbackupstrategybody>` object | Automatic snapshot creation.                                                                                                                                                                                                                                                                                                                                                                                |
   |                       |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                       |                 |                                                                                                                 | The automatic snapshot creation policy is enabled only if **backupStrategy** is not left blank.                                                                                                                                                                                                                                                                                                             |
   +-----------------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | roles                 | Yes             | Array of :ref:`CreateClusterRolesBody <createclustermultirole__request_createclusterrolesbody>` objects         | Cluster information                                                                                                                                                                                                                                                                                                                                                                                         |
   +-----------------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | nics                  | Yes             | :ref:`CreateClusterInstanceNicsBody <createclustermultirole__request_createclusterinstancenicsbody>` object     | Subnet ID.                                                                                                                                                                                                                                                                                                                                                                                                  |
   +-----------------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | enterprise_project_id | No              | String                                                                                                          | Enterprise project ID. When creating a cluster, associate the enterprise project ID with the cluster. The value can contain a maximum of 36 characters. It is string **0** or in UUID format with hyphens (-). Value **0** indicates the default enterprise project.                                                                                                                                        |
   +-----------------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | tags                  | No              | Array of :ref:`CreateClusterTagsBody <createclustermultirole__request_createclustertagsbody>` objects           | Cluster tag.                                                                                                                                                                                                                                                                                                                                                                                                |
   +-----------------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | availability_zone     | Yes             | String                                                                                                          | One or more AZs. You need to specify the AZ names.                                                                                                                                                                                                                                                                                                                                                          |
   |                       |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                       |                 |                                                                                                                 | By default, a single AZ is specified. If multiple AZs are specified, use commas (,) to separate different AZ names. For example, if three AZs are selected under region-1, the value of availability_zone is region-1a,region-1b,region-1c. If a single AZ is used, the value of availability_zone is empty by default.                                                                                     |
   |                       |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                       |                 |                                                                                                                 | .. note::                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                       |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                       |                 |                                                                                                                 |    Note:                                                                                                                                                                                                                                                                                                                                                                                                    |
   |                       |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                       |                 |                                                                                                                 |    - If multiple AZs are selected, the name of each AZ must be unique, and the number of nodes must be greater than or equal to the number of AZs.                                                                                                                                                                                                                                                          |
   |                       |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                       |                 |                                                                                                                 |    - If the number of nodes is a multiple of the number of AZs, the nodes are evenly distributed to each AZ.                                                                                                                                                                                                                                                                                                |
   |                       |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                       |                 |                                                                                                                 | -  If the number of nodes is not a multiple of the number of AZs, the absolute difference between node quantity in any two AZs is 1 at most.                                                                                                                                                                                                                                                                |
   |                       |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                       |                 |                                                                                                                 | -  Obtain the AZ names from :ref:`Regions and Endpoints <css_03_0001>` in section "Before You Start".                                                                                                                                                                                                                                                                                                       |
   +-----------------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | datastore             | Yes             | :ref:`CreateClusterDatastoreBody <createclustermultirole__request_createclusterdatastorebody>` object           | Engine type. Its value can be elasticsearch, opensearch, or logstash.                                                                                                                                                                                                                                                                                                                                       |
   +-----------------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | authorityEnable       | No              | Boolean                                                                                                         | Whether to enable authentication. The value can be **true** or **false**. Authentication is disabled by default.                                                                                                                                                                                                                                                                                            |
   |                       |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                       |                 |                                                                                                                 | -  **true**: Authentication is enabled for the cluster.                                                                                                                                                                                                                                                                                                                                                     |
   |                       |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                       |                 |                                                                                                                 | -  **false**: Authentication is disabled for the cluster.                                                                                                                                                                                                                                                                                                                                                   |
   |                       |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                       |                 |                                                                                                                 | This parameter is supported in clusters 6.5.4 or later.                                                                                                                                                                                                                                                                                                                                                     |
   +-----------------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | httpsEnable           | No              | Boolean                                                                                                         | Whether communication is encrypted on the cluster. The value can be **true** or **false**. By default, communication encryption is disabled. When **httpsEnable** is set to **true**, **authorityEnable** must be set to **true**.- **true**: Communication is encrypted on the cluster.- **false**: Communication is not encrypted for the cluster.This parameter is supported in clusters 6.5.4 or later. |
   +-----------------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | adminPwd              | No              | String                                                                                                          | Password of the cluster user **admin** in security mode. This parameter is mandatory only when **authorityEnable** is set to **true**. Input requirements:                                                                                                                                                                                                                                                  |
   |                       |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                       |                 |                                                                                                                 | -  Must contain 8 to 32 characters.                                                                                                                                                                                                                                                                                                                                                                         |
   |                       |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                       |                 |                                                                                                                 | -  Must contain at least three of the following character types: letters, digits, and special characters ``~!@#$%^&*()-_=+\|[{}];:,<.>/?``                                                                                                                                                                                                                                                                  |
   +-----------------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | publicIPReq           | No              | :ref:`CreateClusterPublicIpReq <createclustermultirole__request_createclusterpublicipreq>` object               | Public network access information. This parameter is valid only when **httpsEnable** is set to **true**.                                                                                                                                                                                                                                                                                                    |
   +-----------------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | loadBalance           | No              | :ref:`CreateClusterLoadBalance <createclustermultirole__request_createclusterloadbalance>` object               | VPC endpoint service information                                                                                                                                                                                                                                                                                                                                                                            |
   +-----------------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | publicKibanaReq       | No              | :ref:`CreateClusterPublicKibanaReq <createclustermultirole__request_createclusterpublickibanareq>` object       | Kibana public network access information. This parameter is valid only when **authorityEnable** is set to **true**.                                                                                                                                                                                                                                                                                         |
   +-----------------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | ipv6_enable           | No              | Boolean                                                                                                         | Whether to enable automatic IPv6 address assignment for the cluster. The default value is false.                                                                                                                                                                                                                                                                                                            |
   +-----------------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | diskEncryption        | No              | :ref:`diskEncryptionInfo <createclustermultirole__request_diskencryptioninfo>` object                           | Disk encryption information.                                                                                                                                                                                                                                                                                                                                                                                |
   +-----------------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _createclustermultirole__request_createclusterbackupstrategybody:

.. table:: **Table 4** CreateClusterBackupStrategyBody

   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type            | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
   +=================+=================+=================+=============================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================================+
   | period          | Yes             | String          | Time when a snapshot is generated every day. Snapshots can only be generated on the hour. The format is HH:mm z: HH:mm refers to the hour time and z refers to the time zone. For example, 00:00 GMT+08:00 and 01:00 GMT+08:00.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                 | .. note::                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                 |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                 |    The default value is 00:00 GMT+08:00. When frequency is set to HOUR, you do not need to specify period. By default, snapshot creation starts from the next hour after the settings are successful.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | frequency       | No              | String          | Frequency of automatically creating snapshots.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
   |                 |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                 | .. note::                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   |                 |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                 |    The default value is DAY. If this parameter is set to HOUR, the scheduled task is executed every hour. If this parameter is set to DAY, the scheduled task is executed every day. If this parameter is set to SUN, MON, TUE, WED, THU, FRI or SAT, the scheduled task is executed at the specified day of every week. For example, SUN indicates that the task is executed once every Sunday. The number of retained snapshots depends on the execution frequency and indexes set in the automatic snapshot creation policy. If the execution interval is short or the index data volume is large, the number of retained automatic snapshots may not reach the preset value. Set this value based on actual conditions. |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | prefix          | Yes             | String          | Prefix of a snapshot that is automatically created, which is manually entered. Enter up to 32 characters and start with a lowercase letter. Lowercase letters, digits, hyphens (-), and underscores (_) are allowed.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | keepday         | Yes             | Integer         | Set the number of retained snapshots. The value ranges from 1 to 90. Expired snapshots will be automatically deleted on the half hour. The deletion policy applies only to automated snapshots that are executed at the same frequency as the current automatic snapshot creation policy.                                                                                                                                                                                                                                                                                                                                                                                                                                   |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | bucket          | No              | String          | Name of the OBS bucket used for backup.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | basePath        | No              | String          | Storage path of the snapshot in the OBS bucket.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | agency          | No              | String          | IAM agency used to access OBS.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
   |                 |                 |                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                 | If none of the **bucket**, **base_path**, and **agency** parameters are specified, the system will automatically create an OBS bucket and an IAM agency. If the creation fails, you need to manually configure correct parameters.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
   +-----------------+-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _createclustermultirole__request_createclusterrolesbody:

.. table:: **Table 5** CreateClusterRolesBody

   +-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type                                                                                                            | Description                                                                                                                                                                                                                                                                                                 |
   +=================+=================+=================================================================================================================+=============================================================================================================================================================================================================================================================================================================+
   | flavorRef       | Yes             | String                                                                                                          | Instance flavor. For details about the current instance flavor, see the **name** attribute in :ref:`Obtaining the Instance Specifications List <listflavors>`.                                                                                                                                              |
   +-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | volume          | Yes             | :ref:`CreateClusterInstanceVolumeBody <createclustermultirole__request_createclusterinstancevolumebody>` object | Volume information. If **flavorRef** is set to a local disk flavor, leave this parameter blank. Obtain the the local disk flavor by referring to the **diskrange** attribute in :ref:`Obtaining the Instance Specifications List <listflavors>`. Currently, the following local disk flavors are supported: |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  **ess.spec-i3small**                                                                                                                                                                                                                                                                                     |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  **ess.spec-i3medium**                                                                                                                                                                                                                                                                                    |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  **ess.spec-i3.8xlarge.8**                                                                                                                                                                                                                                                                                |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  **ess.spec-ds.xlarge.8**                                                                                                                                                                                                                                                                                 |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  **ess.spec-ds.2xlarge.8**                                                                                                                                                                                                                                                                                |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  **ess.spec-ds.4xlarge.8**                                                                                                                                                                                                                                                                                |
   +-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | type            | Yes             | String                                                                                                          | -  **ess-master** indicates a master node.                                                                                                                                                                                                                                                                  |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  **ess-client** indicates a client node.                                                                                                                                                                                                                                                                  |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  **ess-cold** indicates a cold data node.                                                                                                                                                                                                                                                                 |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  **ess** indicates a data node.                                                                                                                                                                                                                                                                           |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  **lgs** indicates a Logstash node.                                                                                                                                                                                                                                                                       |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 |    [- **chinese** indicates a Chinese language model.                                                                                                                                                                                                                                                       |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  **english** indicates an English language model.                                                                                                                                                                                                                                                         |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  **arabic** indicates an Arabic model.                                                                                                                                                                                                                                                                    |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  **thai** indicates a Thai model.                                                                                                                                                                                                                                                                         |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  **turkish** indicates a Turkish language model.                                                                                                                                                                                                                                                          |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  **tools** indicates a tools model.] (tag:white)                                                                                                                                                                                                                                                          |
   +-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | instanceNum     | Yes             | Integer                                                                                                         | Number of instances.                                                                                                                                                                                                                                                                                        |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  If **ess** is selected, you can set the value to 1 to 32.                                                                                                                                                                                                                                                |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 |    -  If both **ess** and **ess-master** are selected, you can set the value to 1 to 200.                                                                                                                                                                                                                   |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 |    -  If both **ess** and **ess-client** are selected, you can set the value to 1 to 32.                                                                                                                                                                                                                    |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 |    -  If both **ess** and **ess-cold** are selected, you can set the value to 32.                                                                                                                                                                                                                           |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  If **ess-master** is selected, you can set the value to 3 to 10.                                                                                                                                                                                                                                         |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  If **ess-client** is selected, you can set the value to 1 to 32.                                                                                                                                                                                                                                         |
   |                 |                 |                                                                                                                 |                                                                                                                                                                                                                                                                                                             |
   |                 |                 |                                                                                                                 | -  If **ess-cold** is selected, you can set the value to 1 to 32.                                                                                                                                                                                                                                           |
   +-----------------+-----------------+-----------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _createclustermultirole__request_createclusterinstancevolumebody:

.. table:: **Table 6** CreateClusterInstanceVolumeBody

   +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type            | Description                                                                        |
   +=================+=================+=================+====================================================================================+
   | volume_type     | Yes             | String          | Volume type                                                                        |
   |                 |                 |                 |                                                                                    |
   |                 |                 |                 | -  COMMON: common I/O                                                              |
   |                 |                 |                 |                                                                                    |
   |                 |                 |                 | -  HIGH: high I/O                                                                  |
   |                 |                 |                 |                                                                                    |
   |                 |                 |                 | -  ULTRAHIGH: ultra-high I/O                                                       |
   |                 |                 |                 |                                                                                    |
   |                 |                 |                 | -  ESSD: ultra-fast SSD                                                            |
   +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------+
   | size            | Yes             | Integer         | Volume size. The value must be greater than 0 and a multiple of 4 and 10. Unit: GB |
   +-----------------+-----------------+-----------------+------------------------------------------------------------------------------------+

.. _createclustermultirole__request_createclusterinstancenicsbody:

.. table:: **Table 7** CreateClusterInstanceNicsBody

   +-----------------+-----------+------------------+--------------------------------------------------------+
   | Parameter       | Mandatory | Type             | Description                                            |
   +=================+===========+==================+========================================================+
   | vpcId           | Yes       | String           | VPC ID, which is used for configuring cluster network. |
   +-----------------+-----------+------------------+--------------------------------------------------------+
   | netId           | Yes       | String           | Subnet ID (network ID).                                |
   +-----------------+-----------+------------------+--------------------------------------------------------+
   | securityGroupId | Yes       | String           | Security group ID.                                     |
   +-----------------+-----------+------------------+--------------------------------------------------------+
   | ips             | No        | Array of strings | Node IP address.                                       |
   +-----------------+-----------+------------------+--------------------------------------------------------+

.. _createclustermultirole__request_createclustertagsbody:

.. table:: **Table 8** CreateClusterTagsBody

   +-----------+-----------+--------+-----------------------------------------------------------------------------------------------------------------------------+
   | Parameter | Mandatory | Type   | Description                                                                                                                 |
   +===========+===========+========+=============================================================================================================================+
   | key       | Yes       | String | Tag key. The value can contain 1 to 36 characters. It can only contain digits, letters, hyphens (-), and underscores (_).   |
   +-----------+-----------+--------+-----------------------------------------------------------------------------------------------------------------------------+
   | value     | Yes       | String | Tag value. The value can contain 0 to 43 characters. It can only contain digits, letters, hyphens (-), and underscores (_). |
   +-----------+-----------+--------+-----------------------------------------------------------------------------------------------------------------------------+

.. _createclustermultirole__request_createclusterdatastorebody:

.. table:: **Table 9** CreateClusterDatastoreBody

   +-----------------+-----------------+-----------------+----------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type            | Description                                                                                                          |
   +=================+=================+=================+======================================================================================================================+
   | version         | Yes             | String          | Version of the CSS cluster engine. For details, see the supported versions in :ref:`Before You Start <css_03_0001>`. |
   |                 |                 |                 |                                                                                                                      |
   |                 |                 |                 | [For a serverless cluster, logs, search, and vector are supported.] (tag:white)                                      |
   +-----------------+-----------------+-----------------+----------------------------------------------------------------------------------------------------------------------+
   | type            | Yes             | String          | Engine type. Its value can be elasticsearch, opensearch, or logstash.                                                |
   |                 |                 |                 |                                                                                                                      |
   |                 |                 |                 | [For a serverless cluster, serverless-opensearch is used.] (tag:white)                                               |
   +-----------------+-----------------+-----------------+----------------------------------------------------------------------------------------------------------------------+

.. _createclustermultirole__request_createclusterpublicipreq:

.. table:: **Table 10** CreateClusterPublicIpReq

   +-----------------+-----------+-----------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Mandatory | Type                                                                                                | Description                                                                                                                         |
   +=================+===========+=====================================================================================================+=====================================================================================================================================+
   | eip             | Yes       | :ref:`CreateClusterPublicEip <createclustermultirole__request_createclusterpubliceip>` object       | Public network bandwidth.                                                                                                           |
   +-----------------+-----------+-----------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
   | elbWhiteListReq | Yes       | :ref:`CreateClusterElbWhiteList <createclustermultirole__request_createclusterelbwhitelist>` object | EIP whitelist.                                                                                                                      |
   +-----------------+-----------+-----------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
   | publicBindType  | Yes       | String                                                                                              | Whether to automatically bind an EIP. Specifies whether to automatically bind an EIP. Currently, only **auto_assign** is supported. |
   +-----------------+-----------+-----------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+
   | eipId           | No        | String                                                                                              | EIP ID.                                                                                                                             |
   +-----------------+-----------+-----------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------+

.. _createclustermultirole__request_createclusterpubliceip:

.. table:: **Table 11** CreateClusterPublicEip

   +-----------+-----------+-------------------------------------------------------------------------------------------------------+---------------------------+
   | Parameter | Mandatory | Type                                                                                                  | Description               |
   +===========+===========+=======================================================================================================+===========================+
   | bandWidth | Yes       | :ref:`CreateClusterPublicEipSize <createclustermultirole__request_createclusterpubliceipsize>` object | Public network bandwidth. |
   +-----------+-----------+-------------------------------------------------------------------------------------------------------+---------------------------+

.. _createclustermultirole__request_createclusterpubliceipsize:

.. table:: **Table 12** CreateClusterPublicEipSize

   ========= ========= ======= ================
   Parameter Mandatory Type    Description
   ========= ========= ======= ================
   size      Yes       Integer Bandwidth range.
   ========= ========= ======= ================

.. _createclustermultirole__request_createclusterelbwhitelist:

.. table:: **Table 13** CreateClusterElbWhiteList

   +-----------------+-----------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Mandatory | Type    | Description                                                                                                                                          |
   +=================+===========+=========+======================================================================================================================================================+
   | enableWhiteList | Yes       | Boolean | Whether to enable the public network access control.                                                                                                 |
   +-----------------+-----------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------+
   | whiteList       | No        | String  | Public network access control whitelist. Separate the whitelisted network segments or IP addresses with commas (,), and each of them must be unique. |
   +-----------------+-----------+---------+------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _createclustermultirole__request_createclusterloadbalance:

.. table:: **Table 14** CreateClusterLoadBalance

   +---------------------+-----------------+------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | Parameter           | Mandatory       | Type             | Description                                                                                                                                                                                    |
   +=====================+=================+==================+================================================================================================================================================================================================+
   | endpointWithDnsName | Yes             | Boolean          | Whether to enable the private domain name.                                                                                                                                                     |
   |                     |                 |                  |                                                                                                                                                                                                |
   |                     |                 |                  | -  **true**: The private zone is enabled.                                                                                                                                                      |
   |                     |                 |                  |                                                                                                                                                                                                |
   |                     |                 |                  | -  **false**: The private zone is disabled.                                                                                                                                                    |
   +---------------------+-----------------+------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | vpcPermissions      | No              | Array of strings | Access control.                                                                                                                                                                                |
   +---------------------+-----------------+------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | professionVpcep     | No              | Boolean          | Create a professional VPC endpoint.                                                                                                                                                            |
   |                     |                 |                  |                                                                                                                                                                                                |
   |                     |                 |                  | -  **true**: enabled.                                                                                                                                                                          |
   |                     |                 |                  |                                                                                                                                                                                                |
   |                     |                 |                  | -  **false**: disabled.                                                                                                                                                                        |
   +---------------------+-----------------+------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
   | dualstackEnable     | No              | Boolean          | Whether to enable the IPv4/IPv6 dual-stack network. The IPv4/IPv6 dual-stack network can be enabled only when a professional VPC endpoint is created and the VPC of the cluster supports IPv6. |
   |                     |                 |                  |                                                                                                                                                                                                |
   |                     |                 |                  | -  **true**: enabled.                                                                                                                                                                          |
   |                     |                 |                  |                                                                                                                                                                                                |
   |                     |                 |                  | -  **false**: disabled.                                                                                                                                                                        |
   +---------------------+-----------------+------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

.. _createclustermultirole__request_createclusterpublickibanareq:

.. table:: **Table 15** CreateClusterPublicKibanaReq

   +--------------+-----------+-----------------------------------------------------------------------------------------------------------------------------+-------------------------------+
   | Parameter    | Mandatory | Type                                                                                                                        | Description                   |
   +==============+===========+=============================================================================================================================+===============================+
   | eipSize      | Yes       | Integer                                                                                                                     | Bandwidth range.              |
   +--------------+-----------+-----------------------------------------------------------------------------------------------------------------------------+-------------------------------+
   | elbWhiteList | Yes       | :ref:`CreateClusterPublicKibanaElbWhiteList <createclustermultirole__request_createclusterpublickibanaelbwhitelist>` object | Kibana whitelist information. |
   +--------------+-----------+-----------------------------------------------------------------------------------------------------------------------------+-------------------------------+

.. _createclustermultirole__request_createclusterpublickibanaelbwhitelist:

.. table:: **Table 16** CreateClusterPublicKibanaElbWhiteList

   +-----------------+-----------+---------+------------------------------------------------------------------------------------------------------------------------+
   | Parameter       | Mandatory | Type    | Description                                                                                                            |
   +=================+===========+=========+========================================================================================================================+
   | whiteList       | Yes       | String  | Whitelist. Separate the whitelisted network segments or IP addresses with commas (,), and each of them must be unique. |
   +-----------------+-----------+---------+------------------------------------------------------------------------------------------------------------------------+
   | enableWhiteList | Yes       | Boolean | Whether to enable the Kibana access control.                                                                           |
   +-----------------+-----------+---------+------------------------------------------------------------------------------------------------------------------------+

.. _createclustermultirole__request_diskencryptioninfo:

.. table:: **Table 17** diskEncryptionInfo

   +-----------------+-----------------+-----------------+-------------------------------------------------------------------------------------+
   | Parameter       | Mandatory       | Type            | Description                                                                         |
   +=================+=================+=================+=====================================================================================+
   | systemEncrypted | No              | String          | Whether to enable disk encryption. The value can be 0 or 1. The default value is 0. |
   |                 |                 |                 |                                                                                     |
   |                 |                 |                 | 0: Disable disk encryption.                                                         |
   |                 |                 |                 |                                                                                     |
   |                 |                 |                 | 1: Enable disk encryption.                                                          |
   +-----------------+-----------------+-----------------+-------------------------------------------------------------------------------------+
   | systemCmkid     | No              | String          | KMS key ID. This parameter is valid only when **systemEncrypted** is set to 1.      |
   +-----------------+-----------------+-----------------+-------------------------------------------------------------------------------------+

Response Parameters
-------------------

**Status code: 200**

.. table:: **Table 18** Response body parameters

   +-----------+--------------------------------------------------------------------------------------+-----------------+
   | Parameter | Type                                                                                 | Description     |
   +===========+======================================================================================+=================+
   | cluster   | :ref:`CreateClusterResp <createclustermultirole__response_createclusterresp>` object | Cluster object. |
   +-----------+--------------------------------------------------------------------------------------+-----------------+

.. _createclustermultirole__response_createclusterresp:

.. table:: **Table 19** CreateClusterResp

   ========= ====== ============
   Parameter Type   Description
   ========= ====== ============
   id        String Cluster ID.
   name      String Cluster name
   ========= ====== ============

Example Requests
----------------

Example request for creating a pay-per-use cluster.

.. code-block::

   {
     "cluster" : {
       "name" : "css-cluster",
       "backupStrategy" : {
         "period" : "16:00 GMT+08:00",
         "prefix" : "snapshot",
         "keepday" : 7,
         "frequency" : "DAY",
         "bucket" : "OBS-obsName",
         "basePath" : "css_repository/obs-path",
         "agency" : "css_obs_agency"
       },
       "roles" : [ {
         "flavorRef" : "ess.spec-4u8g",
         "volume" : {
           "volume_type" : "COMMON",
           "size" : 100
         },
         "type" : "ess",
         "instanceNum" : 1
       } ],
       "nics" : {
         "vpcId" : "{VPC ID}",
         "netId" : "{NET ID}",
         "securityGroupId" : "{Security group ID}"
       },
       "enterprise_project_id" : 0,
       "tags" : [ {
         "key" : "k1",
         "value" : "v1"
       }, {
         "key" : "k2",
         "value" : "v2"
       } ],
       "availability_zone" : "{Az code}",
       "datastore" : {
         "version" : "{cluster-version}",
         "type" : "elasticsearch"
       },
       "authorityEnable" : true,
       "httpsEnable" : true,
       "adminPwd" : "{password}",
       "publicIPReq" : {
         "eip" : {
           "bandWidth" : {
             "size" : 5
           }
         },
         "elbWhiteListReq" : {
           "enableWhiteList" : true,
           "whiteList" : "127.0.0.1"
         },
         "publicBindType" : "auto_assign",
         "eipId" : null
       },
       "loadBalance" : {
         "endpointWithDnsName" : false,
         "vpcPermissions" : [ "{Account ID}" ]
       },
       "publicKibanaReq" : {
         "eipSize" : 5,
         "elbWhiteList" : {
           "whiteList" : "127.0.0.1",
           "enableWhiteList" : true
         }
       }
     }
   }

Example Responses
-----------------

**Status code: 200**

Request succeeded.

-  Example response for creating a pay-per-use cluster.

   .. code-block::

      {
        "cluster" : {
          "id" : "ef683016-871e-48bc-bf93-74a29d60d214",
          "name" : "ES-Test"
        }
      }

-  Example response for creating a yearly/monthly cluster.

   .. code-block::

      {
        "orderId" : "CS2208241141LY94J",
        "cluster" : {
          "id" : "ef683016-871e-48bc-bf93-74a29d60d214",
          "name" : "ES-Test"
        }
      }

Status Codes
------------

+-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------+
| Status Code                       | Description                                                                                                                        |
+===================================+====================================================================================================================================+
| 200                               | Request succeeded.                                                                                                                 |
+-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------+
| 400                               | Invalid request.                                                                                                                   |
|                                   |                                                                                                                                    |
|                                   | Modify the request before retry.                                                                                                   |
+-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------+
| 409                               | The request could not be completed due to a conflict with the current state of the resource.                                       |
|                                   |                                                                                                                                    |
|                                   | The resource that the client attempts to create already exists, or the update request fails to be processed because of a conflict. |
+-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------+
| 412                               | The server did not meet one of the preconditions contained in the request.                                                         |
+-----------------------------------+------------------------------------------------------------------------------------------------------------------------------------+

Error Codes
-----------

See :ref:`Error Codes <css_03_0076>`.
